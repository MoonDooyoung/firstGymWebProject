<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> <!-- 마이바티스 역할을 한다는 뜻 -->
  
  <mapper namespace="kr.co.firstgym.product.mapper.IProductMapper"><!--이 경로에 있는 인터페이스를 찾음 -->
  
  	<resultMap type="kr.co.firstgym.command.ProductVO" id="ProductVO">
  		<result column="p_num" property="productNum"/>
  		<result column="p_category" property="pCategory"/>
  		<result column="p_company" property="pCompany"/>
  		<result column="p_country" property="pCountry"/>
  		<result column="p_image" property="pImage"/>
  		<result column="p_name" property="pName"/>
  		<result column="p_price" property="pPrice"/>
  		<result column="p_method" property="pMethod"/>
  		<result column="p_sendPrice" property="pSendPrice"/>
  		<result column="p_exchangeInfo" property="pExchangeInfo"/>
  		<result column="p_info" property="pInfo"/>
  	
  		
  	</resultMap>
  	
  	<select id="getList" resultMap="ProductVO">
	  	SELECT * FROM	
	  		(
	  		SELECT ROWNUM AS rn, tbl.* FROM
		  		(
		  		SELECT * 
		  		FROM product
		  		WHERE p_name LIKE '%'||#{text_box}||'%'
		  		ORDER BY p_num DESC
		  		) tbl
		  	)
		<![CDATA[
		WHERE rn > (#{page}-1) * #{countPerPage}
		AND rn <= #{page} * #{countPerPage}
		]]>
  	</select>
  	
  	<!-- 상품조회 -->
  	<select id="getContent" resultType="kr.co.firstgym.command.ProductVO">
  		SELECT *
		FROM product
		WHERE p_num = #{pNum}
  	</select>
  	
  	<!-- 총 게시물의 개수를 구해오자. -->
  	<select id="totalCount" resultType="int">
  		SELECT COUNT(*)
  		FROM product
  		WHERE p_name LIKE '%'||#{text_box}||'%'
  	
  	</select>
  	
  	
  </mapper>
  
  
  
  
  
  
  
  
  
  
  
  
  